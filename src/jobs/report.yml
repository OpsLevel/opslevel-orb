description: >
  This job will report a deploy event for an OpsLevel service by using the OpsLevel CLI.

executor: 'public.ecr.aws/opslevel/cli:v2024.3.15'

parameters:
  integration_url:
    type: string
    description: 'The OpsLevel deploy integration url'
  service:
    type: string
    description: 'The service alias for the event'
    default: ""
  description:
    type: string
    description: 'The description or release notes for the event'
    default: ""
  environment:
    type: string
    description: 'The environment for the event'
    default: ""
  number:
    type: string
    description: 'The deploy number for the event - Default: ${CIRCLE_BUILD_NUM}'
    default: ""
  deployer_name:
    type: string
    description: 'The deployer name who created the event - Default: ${CIRCLE_USERNAME}'
    default: ""
  deployer_email:
    type: string
    description: 'The deployer email who created the event'
    default: ""
  deduplication_id:
    type: string
    description: 'An identifier that can be used to deduplicate deployments'
    default: ""

steps:
  - report:
      integration_url: <<parameters.integration_url>>
      service: <<parameters.service>>
      description: <<parameters.description>>
      environment: <<parameters.environment>>
      number: <<parameters.number>>
      deployer_name: <<parameters.deployer_name>>
      deployer_email: <<parameters.deployer_email>>
      deduplication_id: <<parameters.deduplication_id>>
